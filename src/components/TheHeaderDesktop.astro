---
// import NavBarDesktop from '../components/NavBar3Desktop.astro';
import Icon from "./Icon.astro";
import AtomLogo from "./Atoms/AtomLogo.astro";
import AtomBadge from "./Atoms/AtomBadge.astro";
import AtomFigure from "./Atoms/AtomFigure.astro";
const { NavFont = "new", NavTheme, NavOnHero } = Astro.props;
---
<header
  class="masthead masthead-desktop"
  id="masthead-desktop"
  data-font={NavFont}
  data-theme={NavTheme}
  data-hasHero={NavOnHero}
>
  <div class="primary-nav-container">
    <AtomLogo url="/" icon="henk-logo" width="163" height="14" />
    <nav class="primary-nav">
      <a id="pn-shop" class="hoverlink" href="#shop" data-target="shop">Shop</a>
      <a href="/en/configurator-new-nav">Configurator</a>
      <a href="/en/samples">Samples</a>
      <a id="pn-visit" class="hoverlink" href="#visit" data-target="visit"
        >Visit</a
      >
      <a
        id="pn-inspiration"
        class="hoverlink"
        href="#inspiration"
        data-target="inspiration">Inspiration</a
      >
      <a href="/en/about-us-new-nav">About</a>
    </nav>
    <style is:global>
      .LangMenu {
        display: flex;
        opacity: 0;
        position: absolute;
        top: 28px;
        left: 0;
        pointer-events: none;
      }

      .LangMenu.--status-open {
        opacity: 1;
        pointer-events: all;
      }

      .LangMenu__list {
        list-style: none;
        margin: 0;
      }

      .LangMenu__list-item {
        opacity: 0;
      }

      .LangMenu__list-item:first-child {
        transition: opacity .3s ease .3s;
      }

      .LangMenu__list-item:last-child {
        transition: opacity .3s ease .6s;
      }

      .LangMenu.--status-open .LangMenu__list-item {
        opacity: 1;
      }
    </style>
    <div class="utilities-nav">
      <ul class="utilities-nav__list">
        <li class="utilities-nav__item" id="utilities-nav__search"><a href="#search" onclick="OpenSearchModal(this);">Search</a></li>
        <li class="utilities-nav__item" id="utilities-nav__language">
          <a href="/en">EN</a>
          <span> | </span>
          <a href="/nl">NL</a>
        <!--<li class="utilities-nav__item" id="utilities-nav__language" onmouseleave="HideLangMenu(this)"><a href="#language" onmouseenter="ShowLangMenu(this)" >Language</a>
          &lt;!&ndash; lang menu &ndash;&gt;
          &lt;!&ndash;ShowLangMenu&ndash;&gt;
          <div class="LangMenu">
            <ol class="LangMenu__list">
              <li class="LangMenu__list-item"><a class="LangMenu__link" href="#">English</a></li>
              <li class="LangMenu__list-item"><a class="LangMenu__link" href="#NL">Nederlands</a></li>
            </ol>
          </div>
        </li>-->
        <li class="utilities-nav__item" id="utilities-nav__cart"><AtomBadge isLink={true} badgeNumber="6" /></li>
      </ul>
    </div>
  </div>
  <!-- submenu shop -->
  <div class="submenu" id="mn-shop">
    <div
      class="submenu-main-grid"
    >
      <div class="submenu-main-grid__item">
        <small style="line-height: 14px; letter-spacing: normal;"
          >Products</small
        >
        <ul class="submenu__ul">
          <li>
            <a
                class="category__link submenu__link"
                href="#tables">Tables</a
            >
            <div class="category__list-container">
              <a class="category__header-link" href="/en/products/tables"
                >All Tables</a
              >
              <ul class="category__list">
                <li>
                  <a
                    class="category__list-link"
                    href="/en/products/dining-tables">Dining Tables</a>
                </li>
                <li>
                  <a
                    class="category__list-link"
                    href="/en/products/coffee-tables">Coffee Tables</a>
                </li>
                <li>
                  <a class="category__list-link" href="/en/products/home-desks"
                    >Home Desks</a>
                </li>
                <li>
                  <a
                    class="category__list-link"
                    href="/en/products/bistro-tables">Bistro Tables</a>
                </li>
              </ul>
            </div>
          </li>
          <li>
            <a
              class="category__link submenu__link"
              href="#chairs">Chairs</a
            >
            <div class="category__list-container">
              <a class="category__header-link" href="/en/products/chairs"
                >All Chairs</a
              >
              <ul class="category__list">
                <li>
                  <a
                    class="category__list-link"
                    href="/en/products/dining-chairs">Dining Chairs</a>
                </li>
                <li>
                  <a
                    class="category__list-link"
                    href="/en/products/lounge-chairs">Lounge Chairs</a>
                </li>
                <li>
                  <a
                    class="category__list-link"
                    href="/en/products/dining-benches">Dining Benches</a>
                </li>
                <li>
                  <a class="category__list-link" href="/en/products/stools"
                    >Stools</a>
                </li>
                <li>
                  <a class="category__list-link" href="/en/products/poufs"
                    >Poufs</a>
                </li>
              </ul>
            </div>
          </li>
          <li>
            <a
                class="category__link submenu__link"
                href="#sofas">Sofas</a
            >
            <div class="category__list-container">
              <a class="category__header-link" href="/en/products/tables">All Sofas</a>
              <ul class="category__list">
                <li>
                  <a
                      class="category__list-link"
                      href="/en/products/sofas">Sofas</a>
                </li>
                <li>
                  <a
                      class="category__list-link"
                      href="/en/products/lounge-chairs">Lounge Chairs</a>
                </li>
                <li>
                  <a
                      class="category__list-link"
                      href="/en/products/poufs">Poufs</a>
                </li>
              </ul>
            </div>
          </li>
          <li><a class="submenu__link" href="#cabinets">Cabinets</a></li>
          <li><a class="submenu__link" href="#accessories">Accessories</a></li>
          <li><a class="submenu__link" href="#outdoor">Outdoor</a></li>
        </ul>
      </div>
      <div
        class="category-grid-container"
      >
        <div
            class="submenu__grid category__gallery --category-gallery-active"
        >
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/100/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/101/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/102/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/103/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
        </div>
        <!-- gallery Tables -->
        <div
          class="submenu__grid category__gallery"
        >
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/318/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/319/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/320/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/321/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
        </div>
        <!-- gallery chairs -->
        <div class="submenu__grid category__gallery">
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/400/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Photo of chairs"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/401/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Photo of chairs"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/402/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Photo of chairs"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/403/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Photo of chairs"
          />
        </div>
        <!-- gallery Sofas -->
        <div class="submenu__grid category__gallery">
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/500/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Photo of chairs"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/501/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Photo of chairs"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/502/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Photo of chairs"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/503/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Photo of chairs"
          />
        </div>
      </div>
    </div>
  </div>
  <div class="submenu" id="mn-visit">
    <div class="submenu-main-grid">
      <div class="submenu-main-grid__item">
        <small style="line-height: 14px; letter-spacing: normal;">Visit</small>
        <ul class="submenu__ul">
          <li><a class="submenu__link" href="#stores">Our stores</a></li>
          <li><a class="submenu__link" href="#etc">Interior advice</a></li>
        </ul>
      </div>
      <div class="category-grid-container">
        <div
            class="submenu__grid category__gallery --category-gallery-active"
        >
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/800/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/804/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/802/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/803/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
        </div>

      </div>
    </div>
  </div>
  <div class="submenu" id="mn-inspiration">
    <div class="submenu-main-grid">
      <div class="submenu-main-grid__item">
        <small style="line-height: 14px; letter-spacing: normal;"
          >Inspiration</small
        >
        <ul class="submenu__ul">
          <li><a class="submenu__link" href="/en/blogs">Stories</a></li>
          <li><a class="submenu__link" href="/en/projects">Projects</a></li>
        </ul>
      </div>
      <div class="category-grid-container">
        <div
            class="submenu__grid category__gallery --category-gallery-active"
        >
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/900/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/901/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/902/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
          <AtomFigure
              hasLink="https://disney.com"
              linkTitle="Click to go to Disney website."
              imgUrl="https://picsum.photos/id/903/556/722.webp"
              imgWidth="556"
              imgHeight="722"
              altText="Photo of a cliff with a nice view on the ocean."
              caption="Title here"
          />
        </div>

      </div>

    </div>
  </div>
</header>
<div id="pixel-to-watch"></div>
<script is:inline defer>
  // elements
  const rootElementDesktop = document.documentElement;
  const mastheadDesktop = document.querySelector(".masthead-desktop");
  const primaryNavLinks = document.querySelectorAll(".primary-nav .hoverlink");
  const categoryLinks = document.querySelectorAll(".category__link");
  const categoryGallery = document.querySelectorAll(".category__gallery");
  // console.log(categoryGallery);
  let menuOpen = false;

  // check if navbar is theme dark
  // console.log(mastheadDesktop.getAttribute('data-hasHero'));
  const NavBarHero = mastheadDesktop.getAttribute('data-hasHero');
  if (NavBarHero === false || NavBarHero === null) {
    // padding-top 102 on body
    document.body.style.paddingTop = "102px";
  }

  // checking if doc has scrolled
  let observer = new IntersectionObserver(entries => {
    // console.log(entries);
    if (entries[0].boundingClientRect.y < 0) {
      // console.log("Past 102px!");
      mastheadDesktop.classList.add("--status-scrolled");
    } else {
      // console.log("Not past 102px");
      mastheadDesktop.classList.remove("--status-scrolled");
    }
  });
  observer.observe(document.querySelector("#pixel-to-watch"));

  // LISTENERS

  // when mouse enters masthead-desktop
  mastheadDesktop.addEventListener("mouseenter", function (e) {
    console.log("mouse entered the masthead-desktop");
    if (!menuOpen) {
      // console.log("menu is not open");
      invertMainNav();
    }
  });

  // when mouse leaves masthead-desktop
  mastheadDesktop.addEventListener("mouseleave", function (e) {
    // console.log("mouse left the masthead-desktop");
    mastheadDesktop.classList.remove("--masthead-desktop-hovered");
    if (menuOpen) {
      // console.log("fading out menu");
      fadeOutSubmenu();
    }
  });

  // primary nav links that have a submenu
  primaryNavLinks.forEach(function (currentElement, currentIndex, listObj) {
    // disable clicking on these
    currentElement.addEventListener("click", function (event) {
      // handlePrimaryLinks(currentElement, event);
      event.preventDefault();
    });

    // set mouse over listener
    currentElement.addEventListener("mouseover", function (event) {
      // console.log("mouseover called on primaryNavLink with ID: " + currentElement.id);
      handlePrimaryLinks(currentElement, event);
    });
  });

  // category links ie: Tbales, Chair, Sofas, to open them
  // category__link

  categoryLinks.forEach(function (currentElement, currentIndex, listObj) {
    // handle clicking on these
    currentElement.addEventListener("click", function (event) {
      event.preventDefault();
      handleCategoryLinks(currentIndex, currentElement);
    });

  });

  // FUNCTIONS

  // MainNav
  function invertMainNav() {
    mastheadDesktop.classList.add("--masthead-desktop-hovered");
  }

  function handlePrimaryLinks(currentElement, event) {
    event.preventDefault();
    // check if already open ie has class --hoverlink-active
    if (currentElement.classList.contains("--hoverlink-active")) {
      // console.log("already active");
      return;
    } else {
      const targetSubmenu = currentElement.getAttribute("data-target");
      // console.log("target is: " + targetSubmenu);

      // deactivate any open active link
      const activeLink = mastheadDesktop.querySelector(".--hoverlink-active");
      if (activeLink != null) {
        // console.log(activeLink);
        activeLink.classList.remove("--hoverlink-active");
      }

      // add class active to current hovered one
      currentElement.classList.add("--hoverlink-active");

      const anyOpenSubmenus = mastheadDesktop.querySelector(".--submenu-open");
      if (anyOpenSubmenus != null) {
        // console.log(anyOpenSubmenus);
        anyOpenSubmenus.classList.remove("--submenu-open");
      } else {
        fadeInSubmenu(targetSubmenu);
      }

      mastheadDesktop
        .querySelector("#mn-" + targetSubmenu)
        .classList.add("--submenu-open");
    }
  }

  function fadeInSubmenu(ID) {
    // console.log("fading in submenu with ID: " + ID);
    // add --desktop-menu-open to html element
    mastheadDesktop.querySelector("#mn-" + ID).classList.add("--submenu-fade-in");
    mastheadDesktop
      .querySelector("#mn-" + ID)
      .addEventListener("animationend", fadeInEnded, false);
    rootElementDesktop.classList.add("--desktop-menu-open");
    menuOpen = true;
  }

  function fadeInEnded() {
    // console.log("fade in ended");
    mastheadDesktop
      .querySelector(".--submenu-fade-in")
      .removeEventListener("animationend", fadeInEnded, false);
    mastheadDesktop
      .querySelector(".--submenu-fade-in")
      .classList.remove("--submenu-fade-in");
  }

  function fadeOutSubmenu() {
    const currentlyOpenSubmenu = mastheadDesktop.querySelector(".--submenu-open");
    if (currentlyOpenSubmenu != null) {
      // console.log("fading submenu out");
      mastheadDesktop
        .querySelector(".--submenu-open")
        .classList.add("--submenu-fade-out");
      mastheadDesktop
        .querySelector(".--submenu-open.--submenu-fade-out")
        .addEventListener("animationend", fadeOutEnded, false);
    }
  }

  function fadeOutEnded() {
    // console.log("fade out ended");
    mastheadDesktop
      .querySelector(".--submenu-fade-out")
      .removeEventListener("animationend", fadeOutEnded, false);
    mastheadDesktop
      .querySelector(".--submenu-fade-out")
      .classList.remove("--submenu-fade-out");
    mastheadDesktop
      .querySelector(".--submenu-open")
      .classList.remove("--submenu-open");
    mastheadDesktop
      .querySelector(".--hoverlink-active")
      .classList.remove("--hoverlink-active");
    rootElementDesktop.classList.remove("--desktop-menu-open");
    menuOpen = false;
  }

  function handleCategoryLinks(currentIndex, currentElement) {
    if (document.querySelector(".--category-open") != null) {
      console.log("not null");
      console.log(document.querySelector(".--category-open").classList);
      document
          .querySelector(".--category-open")
          .classList.remove("--category-open");
      document
          .querySelector(".--category-active")
          .classList.remove("--category-active");
    } else {
      console.log("null");
    }
    currentElement.classList.toggle("--category-active");
    currentElement.parentElement.classList.toggle("--category-open");
    // .classList.toggle("--category-gallery-active");
    // console.log(categoryGallery);
    // console.log(categoryGallery[1]);
    if (document.querySelector(".--category-gallery-active") != null) {
      // console.log("not null");
      // console.log(document.querySelector(".--category-gallery-active").classList);
      document
          .querySelector(".--category-gallery-active")
          .classList.remove("--category-gallery-active");
    } else {
      console.log("null");
    }
    let galleryIndex = currentIndex + 1;
    console.log(galleryIndex);
    categoryGallery[galleryIndex].classList.add("--category-gallery-active");
  }

  function OpenSearchModal (ClickedElement) {
    alert("search activated !");
    console.log(ClickedElement);
  }

  function ShowLangMenu (HoveredElement) {
    // alert("LangMenu activated !");
    // console.log(HoveredElement);
    HoveredElement.nextElementSibling.classList.add("--status-open");
  }

  function HideLangMenu (HoveredElement) {
    // HoveredElement.nextElementSibling.classList.remove("--status-open");
    console.log(HoveredElement.querySelector(".--status-open"));
    HoveredElement.querySelector(".--status-open").classList.remove("--status-open");
  }

</script>

<style>
  .category__link {
  }

  .category__list-container {
    display: none;
  }

  .category__header-link,
  .category__list-link {
    text-decoration: none;
  }

  .category__header-link {
    line-height: 40px;
  }

  .category__list {
    margin-left: 1rem;
    list-style: none;
  }

  .category__gallery {
    display: none;
    transition: transform 0.3s ease-in-out;
  }

  .submenu__grid.category__gallery {
    opacity: 1;
    grid-template-columns: repeat(4,1fr);
  }

  .submenu-main-grid {
    display: grid;
    grid-template-columns: 285px 4fr;
    max-width: 1467px;
    margin: 0 auto;
  }

  .submenu__ul .--category-open {

  }

  .--category-active {
    display: none;
  }

  .--category-active + .category__list-container {
    display: block;
    /*background-color: yellow;*/
  }

  .--category-gallery-active {
    display: grid;

    /*transform: translateY(-50%);*/
  }

  .category-grid-container {
    max-height: 401px;
    overflow: hidden;
  }
</style>